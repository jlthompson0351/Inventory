# 06 Reporting and Analytics (Updated August 2025)

**Status**: âœ… **Comprehensive & Accurate**

This document provides a complete overview of the new, guided reporting and analytics features in the BarcodEx application. It is the single source of truth for understanding how to create, manage, and optimize reports using the business-friendly wizard.

---

## âœ¨ **The Guided Report Builder**

The new report builder is designed for both non-technical users and power users. It provides a step-by-step wizard to create powerful, custom reports without needing to know database table names or complex join logic.

### **Core Philosophy: Smart Abstraction, Not Dumbing Down**
Instead of removing features, the new builder **translates** technical concepts into business-friendly terms.
- **Before**: `form_field.123.coating_amount_inches`
- **Now**: "Paint Coating Amount (inches)"

This makes report building intuitive for everyone while retaining the full power of the underlying data.

### **Key Components**
-   **`NewReportBuilder` (`src/pages/NewReportBuilder.tsx`)**: The main UI for the new guided, step-by-step report creation wizard.
-   **`reporting-schema.json` (`src/reporting-schema.json`)**: The **brain** of the new system. This central schema defines:
    - Business-friendly labels for all tables and fields.
    - Categories for grouping related data (e.g., "Assets & Equipment", "Inventory & Stock").
    - "Quick Report" templates for one-click reporting.
    - Smart suggestions and relationships between data sources.
-   **`reportingSchemaService.ts`**: Frontend service that reads the schema to dynamically build the UI.
-   **`execute_report_query` (Supabase RPC)**: A powerful, secure database function that dynamically builds and executes SQL queries based on the user's selections and the schema's rules.

---

## ðŸ“– **User Guide: Building a Report in 4 Steps**

### **Step 1: Choose How to Start**
1.  **Navigate to Reports**: Go to the "Reports" section and click "New Custom Report".
2.  **Choose a Starting Point**:
    -   **Quick Reports**: Select a pre-built template like "Asset Overview" or "Current Stock Levels" for instant results. This is the fastest way to get a standard report.
    -   **Custom Report**: Pick a data category like "Assets & Equipment" or "Inventory & Stock" to start building a report from scratch.

### **Step 2: Select Your Data**
-   If you chose a custom report, you'll be shown a list of business-friendly data sources (e.g., "Assets & Equipment", "Inventory & Stock Items").
-   Select one or more sources to include in your report. The system automatically knows how to join them.

### **Step 3: Pick Your Columns**
-   Based on your selected data sources, you'll see a list of available columns, organized into logical categories (e.g., "Basic Information", "Identification", "Status & Condition").
-   Simply check the boxes for the information you want to see.
-   **Smart Suggestions** will appear, recommending related fields or data sources to add.

### **Step 4: Preview & Save**
-   A live preview of your report is generated.
-   From here, you can:
    - **Export to Excel**: Download your data with clean, business-friendly column headers.
    - **Save Report**: Save the configuration to run again later.

---

## âš¡ **Advanced Features & Performance**

-   **Business Mode Toggle**: While the default view uses simple, business-friendly labels, you can toggle "Business Mode" off to see the underlying technical field names.
-   **Dynamic Query Generation**: All queries are safely and dynamically generated by the `execute_report_query` Supabase function, which uses the `reporting-schema.json` to construct valid and efficient SQL.
-   **Performance**: The system is built on the same performant foundation of database indexing, server-side logic, and materialized views as the legacy system. The new schema-driven approach allows for even greater optimization in the future.

---

## troubleshooting

-   **Slow Reports?**: The system provides warnings for reports with many columns or data sources. Try adding filters (coming soon!) to narrow down the date range.
-   **Missing Data?**: Ensure that data exists for the sources and fields you've selected.
-   **Incorrect Data?**: Verify the data in the source tables. The report builder simply displays what is in the database based on your configuration.
